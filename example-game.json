{
  "main": {
    "player": {
      "@room": "room_cell",
      "@inventory": "",
      "@invalid": "That command isn't valid.",
      "@test": ""
    },
    "global": {
      "@effects": "setList($_validCommands, [TAKE, CLEAN, OPEN, MOVE, LOOK]); display(You can use 'help' for a command list.); function(show_commands, $amount) { print(Available commands:); for(set($i, 0), lesser($i, $amount), inc($i)) { print($i:); print($_validCommands[$i]); if(equals($i, sub($amount, 1))) { print(); } } }"
    },
    "rooms": {
      "room_cell": {
        "@body": "You wake up in a small damp cell. A rusty key lies on the ground next to a locked door. You want to go outside."
      },
      "room_hall": {
        "@body": "Fresh air greets you as you step into the hallway. You're free!"
      }
    },
    "items": {
      "item_rusty_key": {},
      "item_clean_key": {},
      "open_door": {}
    },
    "commands": {
      "help": {
        "@effects": "\nshow_commands(5);\n"
      },
      "take": {
        "key": {
          "@effects": "display(You pick up the rusty key.); addItem(item_rusty_key);"
        },
        "default": {
          "@effects": "display(Take what?);"
        }
      },
      "clean": {
        "key": {
          "@effects": "if(hasItem(item_rusty_key)) { addItem(item_clean_key); deleteItem(item_rusty_key); display(You clean the key until it shines.); } else { display(You don't have anything to clean.); }"
        },
        "default": {
          "@effects": "display(Clean what?);"
        }
      },
      "open": {
        "door": {
          "@effects": "if(hasItem(item_clean_key)) { display(You unlock the door.); addItem(open_door); } else { display(The door is locked tight. It'd need a clean key to open.); }"
        },
        "default": {
          "@effects": "display(Open what?);"
        }
      },
      "move": {
        "outside": {
          "@effects": "if(hasItem(open_door)) {move(room_hall);} else {display(There's a door in the way.);}"
        },
        "default": {
          "@effects": "display(Move where?);"
        }
      },
      "look": {
        "@effects": "if(includes(getProperty(player, @inventory), key)) { print(There's a clear floor.); } else { print(There's a key on the floor.); } print(There's a door as well.); print(You want to go outside.);"
      }
    },
    "dummy": {}
  }
}